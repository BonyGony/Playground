## 1장 사용자 수에 따른 규모 확장

<b>데이터베이스</b>  
ㄴ 사용자 증가에 따라 단일 서버로는 충분하지 않아서 여러 서버를 두어야 함  
ㄴ 웹/모바일 트래픽 처리 용도와 데이터베이스 서버를 분리  
ㄴ 각각을 독립적으로 확장해 나갈 수 있음

<b>비 관계형 데이터베이스(NoSQL)</b>  
ㄴ 다음과 같은 경우 비 관계형 데이터베이스 사용을 권장  
&nbsp;&nbsp;&nbsp;&nbsp;ㄴ 아주 낮은 응답 지연시간(latency)이 요구  
&nbsp;&nbsp;&nbsp;&nbsp;ㄴ 다루는 데이터가 비정형(unstructured)  
&nbsp;&nbsp;&nbsp;&nbsp;ㄴ 데이터를 직렬화하거나 역직렬화 할 수 있기만 하는 경우  
&nbsp;&nbsp;&nbsp;&nbsp;ㄴ 아주 많은 양의 데이터 저장

<b>수직적 규모 확장(scale up) vs 수평적 규모 확장(scale out)</b>  
ㄴ 서버로 유입되는 트래픽의 양이 적을 때는 수직적 확장  
&nbsp;&nbsp;&nbsp;&nbsp;ㄴ 규모 확장의 한계가 존재, 한 대의 서버에 CPU나 메모리를 무한대로 증성할 방법은 없음  
&nbsp;&nbsp;&nbsp;&nbsp;ㄴ 자동복구(failover) 방안이나 다중화(redundancy) 방안을 제시하지 않음  
ㄴ 대규모 애플리케이션을 지원하는 데는 수평적 규모 확장법이 보다 적절

<b>로드 밸런서</b>  
ㄴ 부하 분산 집합(load balancing set)에 속한 웹 서버들에게 트래픽 부하를 고르게 분산하는 역활  
ㄴ 사용자는 로드밸런서의 Public IP주소로 접속, 웹 서버는 클라이언트의 접속을 직접 처리하지 않음  
&nbsp;&nbsp;&nbsp;&nbsp;ㄴ 서버 간 통신에는 보안을 위해 Private IP주소를 이용  
&nbsp;&nbsp;&nbsp;&nbsp;ㄴ Private IP주소는 같은 네트워크에 속한 서버 사이의 통신에서만 사용 가능  

<b>데이터베이스 다중화</b>  
ㄴ 서버 사이에 master-slave 관계를 설정, 원본은 주 서버, 사본은 부 서버에 저장  
ㄴ 쓰기 연산은 주 서버에서만 지원, 부 서버는 사본을 전달 받아 읽기 연산만을 지원  

<b>캐시</b>  
ㄴ 요청을 받은 웹 서버는 캐시 서버에 응답이 저장되어 있는지 확인, 없는 경우 데이터베이스를 통해 데이터를 찾아 캐시에 저장한 뒤 클라이언트로 반환  
ㄴ 데이터 갱신은 자주 일어나지 않지만 참조는 빈번하게 일어나는 경우 효율적  
ㄴ 만료 정책이 없으면 캐시에 계속 남게 되고, 짧으면 데이터베이스를 너무 자주 읽게 되며, 길면 원본과 차이가 발생  

<b>콘텐츠 전송 네트워크</b>  
ㄴ 정적 콘텐츠 전송에 쓰이는 지리적으로 분산된 서버의 네트워크, 이미지 비디오 등을 캐시할 수 있음  
ㄴ 요청 경로, 질의 문자열, 쿠키, 요청 헤더 등의 정보에 기반하여 HTML 페이지를 캐시  

<b>무상태(stateless) 웹 계층</b>  
ㄴ 웹 계층을 수평적으로 확장하는 방법으로 상태 정보(사용자 세션 데이터와 같은)를 웹 계층에서 제거  

<b>메시지 큐</b>  
ㄴ 메시지의 무손실을 보장하는 비동기 통신을 지원하는 컴포넌트  
ㄴ 생상자는 메시지를 메시지 큐에 발행(publish)하고, 소비자는 메시지를 받아 그에 맞는 동작을 수행  
ㄴ 서비스 또는 서버 간 결합이 느슨해져서, 규모 확장성이 보장되어야 하는 안정된 애플리케이션을 구성하기 좋음  
&nbsp;&nbsp;&nbsp;&nbsp;ㄴ 반대의 프로세스가 다운되어 있어도 메시지를 발행 또는 소비할 수 있음  
ㄴ 생산자와 소비자 서비스의 규모를 독립적으로 확장 가능   

<b>샤딩</b>  
ㄴ 대규모 데이터베이스를 샤드(shard)라고 부르는 작은 단위로 분할하는 기술  
ㄴ 모든 샤드는 같은 스키마를 쓰지만 샤드에 보관되는 데이터 사이에 중복은 없음  
ㄴ 샤딩 키(파티션 키 partition key)로 어떻게 데이터를 분산될지 정하는 것이 중요  




